<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fuzzy Link Search</title>
  <style>
    :root{
      --bg1:#0a0f1c;
      --bg2:#0d1528;
      --card:#101b33;
      --accent:#6ee7b7;
      --muted:#9aa4b2;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      height:100vh;
      background:linear-gradient(180deg,var(--bg1),var(--bg2));
      font-family:Inter,ui-sans-serif,system-ui;
      color:#e7eef7;
      display:flex;
      justify-content:center;
      align-items:center;
      overflow:hidden;
    }

    .wrap{
      width:100%;
      max-width:740px;
      padding:20px;
      position:relative;
      transition:transform .35s ease, margin-top .35s ease;
    }

    .wrap.top{
      margin-top:-180px;
    }

    .searchBox{
      width:100%;
      position:relative;
    }

    #placeholderInfo{
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      color:var(--muted);
      font-size:14px;
      pointer-events:none;
      opacity:.75;
      transition:opacity .2s ease;
    }

    .inputLarge{
      width:100%;
      padding:22px 20px;
      font-size:20px;
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,0.07);
      background:rgba(255,255,255,0.06);
      color:inherit;
      backdrop-filter:blur(6px);
      outline:none;
      transition:background .2s, box-shadow .2s;
    }
    .inputLarge:focus{
      background:rgba(255,255,255,0.1);
      box-shadow:0 0 0 2px var(--accent);
    }

    .list{
      margin-top:26px;
      display:grid;
      gap:12px;
      max-height:60vh;
      overflow:auto;
      padding-right:6px;
    }

    .item{
      background:rgba(255,255,255,0.05);
      padding:14px 16px;
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,0.05);
      cursor:pointer;
      display:flex;
      flex-direction:column;
      transition:background .15s, transform .15s;
      outline:none;
    }
    .item:hover{
      background:rgba(255,255,255,0.09);
      transform:translateY(-2px);
    }
    .item:focus{
      background:rgba(255,255,255,0.12);
      box-shadow:0 0 0 2px var(--accent);
    }

    .titleName{
      font-weight:600;
    }
    .url{
      margin-top:6px;
      font-size:13px;
      color:var(--muted);
    }

    .empty{
      text-align:center;
      padding:20px;
      color:var(--muted);
    }
  </style>
</head>
<body>

  <div id="wrap" class="wrap">

    <div class="searchBox">
      <div id="placeholderInfo"></div>
      <input id="search" class="inputLarge" autofocus autocomplete="off" />
    </div>

    <div id="results" class="list" aria-live="polite"></div>
  </div>

  <script>
    const LINKS = [
      {title:'Google',url:'https://www.google.com'},
      {title:'GitHub',url:'https://github.com'},
      {title:'Stack Overflow',url:'https://stackoverflow.com'},
      {title:'MDN Web Docs',url:'https://developer.mozilla.org'},
      {title:'YouTube',url:'https://www.youtube.com'},
      {title:'Wikipedia',url:'https://www.wikipedia.org'},
      {title:'České noviny',url:'https://www.novinky.cz'},
      {title:'Hacker News',url:'https://news.ycombinator.com'}
    ];

    // fuzzy tools
    function levenshtein(a,b){
      if(!a||!b)return(a||b)?Math.max(a.length,b.length):0;
      const m=a.length,n=b.length;
      const dp=Array(m+1).fill().map(()=>Array(n+1).fill(0));
      for(let i=0;i<=m;i++)dp[i][0]=i;
      for(let j=0;j<=n;j++)dp[0][j]=j;
      for(let i=1;i<=m;i++){
        for(let j=1;j<=n;j++){
          const cost=a[i-1]===b[j-1]?0:1;
          dp[i][j]=Math.min(dp[i-1][j]+1,dp[i][j-1]+1,dp[i-1][j-1]+cost);
        }
      }
      return dp[m][n];
    }

    function scoreMatch(q, target){
      q=q.toLowerCase(); target=target.toLowerCase();
      if(target===q) return 999; // exact URL match → strongest
      if(target.includes(q)) return 5 + q.length/target.length;
      const d=levenshtein(q,target);
      const maxLen=Math.max(q.length,target.length);
      const sim=1-(d/maxLen);
      return Math.max(0,sim);
    }

    function computeScore(q,item){
      return scoreMatch(q,item.title)*1.2 + scoreMatch(q,item.url);
    }

    const input=document.getElementById('search');
    const results=document.getElementById('results');
    const wrap=document.getElementById('wrap');
    const placeholder=document.getElementById('placeholderInfo');

    function today(){
      const d=new Date();
      return d.toLocaleDateString('cs-CZ',{weekday:'long',day:'numeric',month:'long'});
    }

    placeholder.textContent=today();

    let filtered=[...LINKS];
    let selected=-1;

    function render(){
      results.innerHTML='';
      if(!filtered.length){
        const e=document.createElement('div');
        e.className='empty';
        e.textContent='Žádné výsledky';
        results.appendChild(e);
        return;
      }
      filtered.forEach((it,i)=>{
        const el=document.createElement('div');
        el.className='item';
        el.tabIndex=0;
        el.dataset.index=i;
        el.innerHTML=`<div class="titleName">${escape(it.title)}</div><div class="url">${escape(it.url)}</div>`;
        el.addEventListener('click',()=>openUrl(it.url));
        el.addEventListener('keydown',ev=>{if(ev.key==='Enter')openUrl(it.url);});
        results.appendChild(el);
      });
    }

    function escape(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
    function openUrl(u){window.open(u,'_blank');}

    function update(q){
      q=q.trim();
      if(!q){filtered=[...LINKS]; render(); return;}

      // if exact URL typed → open immediately
      try{
        if(q.startsWith('http')){
          const normalized=q.replace(/\/$/,"");
          const hit=LINKS.find(l=>l.url.replace(/\/$/,"")===normalized);
          if(hit){openUrl(hit.url); return;}
        }
      }catch{}

      filtered=LINKS.map(i=>({...i,_s:computeScore(q,i)}))
                    .filter(i=>i._s>0)
                    .sort((a,b)=>b._s-a._s);
      render();
    }

    input.addEventListener('input',e=>{
      const val=e.target.value;
      placeholder.style.opacity=val?0:1;
      wrap.classList.toggle('top', !!val);
      update(val);
    });

    input.addEventListener('keydown',e=>{
      if(e.key==='Enter'){
        e.preventDefault();
        if(selected>=0 && filtered[selected]) openUrl(filtered[selected].url);
        else if(filtered[0]) openUrl(filtered[0].url);
      }
    });

    document.addEventListener('keydown',e=>{
      if(e.key==='/' && document.activeElement!==input){e.preventDefault();input.focus();}
    });

    render();

  </script>
</body>
</html>
